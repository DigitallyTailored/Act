(()=>{var _={_uid_val:0,_views:{},target:!1,load(e){let t=e.map(r=>import(r[1]).then(c=>{this._views[r[0]]=c.default}));return Promise.all(t)},render(e,t=!1,r=!0,c=!0){if(t=t||this.target,r)for(;t?.firstChild;)t.removeChild(t.firstChild);Array.isArray(e)||(e=[e]);let h=[];e.forEach(i=>{if(typeof i=="string"||typeof i=="number")t.insertAdjacentHTML(c?"beforeend":"afterbegin",i);else{t.insertAdjacentElement(c?"beforeend":"afterbegin",i);let s=i.act.values(),l=this._views[s.act.viewName];if(s.act.parent=()=>t,l.style&&!this.target.querySelector(`style[data-act_style="${s.act.viewName}"]`)){let n=document.createElement("style");n.dataset.act_style=s.act.viewName;let d=l.style(s);d=d.replace(/([\w\d.#]+)(\s*\{)/g,(o,y,w)=>`${y}${s.act.style} ${w}
`),n.innerHTML=d,this.target.insertAdjacentElement("afterbegin",n)}h.push(i),i.querySelectorAll("act-watch").forEach(n=>{let d=s.act._watchers[n.dataset.act_watch_key];debugger;act.listen(d.name,o=>{n.innerText=d.event(s)}),n.innerText=d.event(s)}),s?.body&&this.render(s.body,i.querySelector("act-body"))}});for(let i=0;i<h.length;i++){let s=h[i],l=s.act.values(),f=this._views[l.act.viewName];if(f?.script&&f.script(l),l?.on){let n=l.on;Array.isArray(n)||(n=[n]);for(let d=0;d<n.length;d++){let o=Object.keys(n[d])[0],y=n[d][o];s.addEventListener(o,w=>{y(w,l)})}}}},view(e,t={}){this._views[e]?.values&&(t={on:[],...this._views[e].values(t),...t}),t.act={},t.act.viewName=e,t.act.view=`[data-act_view="${t.act.viewName}"]`,t.act.style=`[data-act_style="${t.act.viewName}"]`,t.act._uid=this.uid();let r=this._views[e],c=document.createElement("div");t.act._watchers=[],t.watch=(i,s=null)=>(s===null&&(s=i,i="*"),t.act._watchers.push({name:i,event:s}),`<act-watch data-act_watch="${i}" data-act_watch_key="${t.act._watchers.length-1}"></act-watch>`),t?.body&&(t.act._body=t.body,t.body="<act-body></act-body>"),c.innerHTML=r.view(t),t?.body&&(t.body=t.act._body,delete t.act._body);let h=c.querySelectorAll("*");for(let i=0;i<h.length;i++)h[i].setAttribute("data-act_style",e);return c=c.children[0],c.act={},c.act.values=()=>t,t.act.element=()=>c,c.classList.add(t.act._uid),c.dataset.act_view=e,t.act.append=(i,s)=>this.append(s,i),t.act.find=i=>c.querySelector(i),t.act.findAll=i=>c.querySelectorAll(i),t.act.findView=i=>c.querySelector(`[data-act_view="${i}"]`),t.act.findViews=i=>c.querySelectorAll(`[data-act_view="${i}"]`),c},uid(){return this._uid_val++,"act_uid_"+this._uid_val},prepend(e,t){this.render(e,t,!1,!1)},append(e,t){this.render(e,t,!1)}};var p={state:{},listeners:new Set,listenersSpecific:[],get(){return this.state},init(e){let t=Object.keys(e).reduce((r,c)=>(this.state[c]!==e[c]&&(r[c]=e[c]),r),{});return this.state={...this.state,...e},t},set(e){let t=this.init(e);Object.keys(t).forEach(r=>{this.listenersSpecific[r]&&this.listenersSpecific[r].forEach(c=>{c(this.state)})}),this.listeners.forEach(r=>r(this.state))},listen(e,t=null){t==null?(t=e,this.listeners.add(t)):(this.listenersSpecific[e]||(this.listenersSpecific[e]=new Set),this.listenersSpecific[e].add(t))},ignore(e,t=null){t==null?(t=e,this.listeners.delete(t)):this.listenersSpecific[e]&&(this.listenersSpecific[e]=this.listenersSpecific[e].filter(r=>r!==t))}};window.a={test:()=>{console.log("test 5")},..._,...p};})();
